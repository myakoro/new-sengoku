# v0.17 詳細設計書：01_方針システム

## 1. 概要

### 1-1. 目的

「盗賊討伐固定」の下知を廃止し、3種類の方針（治安回復/軍備増強/計略）から選ばれる形に変更する。
これにより、毎月同じ流れになる単調さを解消する。

### 1-2. 要件（要件定義書より）

- 方針は3種類（治安回復/軍備増強/計略）
- 毎月異なる方針が出る可能性がある
- プレイヤーには予測不可
- 方針に対する進捗（ゲージ/数値）を可視化

---

## 2. 方針の種類

### 2-1. 治安回復（軍事・領内）

| 項目 | 内容 |
|------|------|
| 目的 | 領内の治安を回復し、百姓が安心して暮らせるようにする |
| 使用可能な手段 | 巡察、情報収集、盗賊討伐 |

#### 2層構造（3ステータス + 手段ゲージ）

| 概念 | 説明 |
|------|------|
| **治安度** | (警備力 + 情報網 + 平穏度) / 3 の平均値。これが目標値（例：60以上） |
| **各目的ステ** | 警備力、情報網、平穏度の3つ。各手段ゲージ100で+1される |
| **手段ゲージ** | 0〜100。100になると対応する目的ステが+1され、ゲージは0にリセット |

#### 方針ゲージ（手柄の目安）

- 方針ゲージは「今月どれだけ手柄を立てたか」の**目安**であり、進捗効率（治安度の上がりやすさ）には影響しない
- 進捗効率に影響するのは後述 of 「手段ゲージ」側

#### 目標値

| 項目 | 値 |
|------|----|
| 初期治安度 | 平均 20 （各ステ初期値 20） |
| 初期手段ゲージ | 0 |
| 最低目標（治安度） | 60 |
| 挑戦目標（治安度） | 80 |
| 卓越目標（治安度） | 95 |

#### 手段ゲージ上昇率と治安度の関係

治安度が低いほど、盗賊など「高リスク・高リターン」の仕事が発生しやすく、ゲージ上昇率が高い。

| 治安度 | 状況 | 手段ゲージ上昇率 | 発生しやすい仕事 |
|--------|------|--------------|------------------|
| 0〜20 | 極めて悪い | ×2.0 | 大規模盗賊討伐、賊軍 |
| 21〜40 | 悪い | ×1.5 | 大規模盗賊討伐、中規模盗賊討伐 |
| 41〜60 | 普通 | ×1.0 | 中規模盗賊討伐、小規模盗賊討伐、巡察 |
| 61〜80 | 良い | ×0.7 | 小規模盗賊討伐、巡察|
| 81〜100 | 極めて良い | ×0.5 | 巡察、情報収集のみ |

#### 設計意図

- 治安が悪い → 盗賊が多い → 討伐で大きくゲージが溜まる → 早く治安が回復
- 治安が良い → 盗賊が少ない → 地道な巡察 → ゲージが溜まりにくい
- **「治安が悪いほど手柄を立てやすいが危険」**というトレードオフが生まれる

### 2-2. 軍備増強（軍事・準備）

| 項目 | 内容 |
|------|------|
| 目的 | 戦に備えて軍備を整える |
| 使用可能な手段 | 訓練、装備整備、演習、城壁改修 |

#### 2層構造（軍備充実度 + 手段ゲージ）

| 概念 | 説明 |
|------|------|
| **軍備充実度** | 0〜100の整数。これが目標値（例：60以上で達成） |
| **手段ゲージ** | 0〜100。100になると軍備充実度が+1され、手段ゲージは0にリセット |

#### 方針ゲージ（手柄の目安）

- 方針ゲージは「軍備増強でどれだけ貢献したか」の**目安**であり、進捗効率（軍備充実度の上がりやすさ）には影響しない
- 進捗効率に影響するのは後述の「手段ゲージ」側

#### 目標値

| 項目 | 値 |
|------|----|
| 初期軍備充実度 | 40（固定） |
| 初期手段ゲージ | 0 |
| 最低目標（軍備充実度） | 60 |
| 挑戦目標（軍備充実度） | 80 |
| 卓越目標（軍備充実度） | 95 |

#### v0.17では「お金払っておしまい系」を手段から除外

- `募兵` や `装備調達` のような「資金受領→購入→終了」になりやすい手段は、v0.17では手段から除外する
- 理由：人脈・組織（取引/信用/供給制約）が未実装の状態だと、理屈は通っても体験として“心が動かない”ため

#### 手段の役割（軍備増強）

- **訓練**：武芸の鍛錬（目的：士気を上げる）
- **装備整備**：既存装備を整える（維持・底上げ、v0.17で残す）
- **演習**：実戦形式の鍛錬（目的：疲労度上限値を上げる）
- **城壁改修**：城の守りを整える（政務寄り。v0.17では「軍備充実度」を進める手段として扱う）

#### 目的ステータスと手段ゲージの対応（軍備増強）

- 軍備増強では、上位の「軍備充実度」を進めるために、各手段がそれぞれ**目的ステータス**を持つ
- 実行した手段に対応する**手段ゲージ**が溜まり、手段ゲージが100に到達したら目的ステータスが上がる

| 手段 | 目的ステータス | 目的ステータスの上限 | 備考 |
|------|----------------|----------------------|------|
| 訓練 | 士気 | 100 | 足軽の士気が上がる（部隊の士気は全員が持つ前提） |
| 演習 | 疲労度上限値 | 120 | 通常は全員100上限。演習により最大120まで上がる |
| 装備整備 | （軍備の底上げ） | - | v0.17では数値ステータスに直結させず、手段ゲージとして軍備充実度に寄与させる |
| 城壁改修 | （防衛の底上げ） | - | v0.17では数値ステータスに直結させず、手段ゲージとして軍備充実度に寄与させる |

#### v0.17での手段効果（ステータス面の具体）

- **訓練**
  - 足軽の士気が上がる（上限100）
  - 目的＝士気、手段ゲージ＝訓練
- **演習**
  - 全員の疲労度上限値が上がる（通常100 → 最大120）
  - 目的＝疲労度上限値、手段ゲージ＝演習
- **装備整備 / 城壁改修**
  - v0.17では目的ステータスの増減に直結させず、軍備充実度を進める手段として扱う

#### 将来の接続（拡張フック）

- 将来、人脈・供給・兵力プール等の仕組みを実装した際に、`募兵` / `装備調達` を手段として追加し、軍備増強の選択肢を拡張できる

#### 手段ゲージ上昇率と軍備充実度の関係（逓減）

軍備が未整備なほど改善余地が大きく、ゲージ上昇率が高い（整ってくるほど逓減する）。

| 軍備充実度 | 手段ゲージ上昇率 |
|------------|--------------|
| 0〜30 | ×1.4 |
| 31〜60 | ×1.0 |
| 61〜80 | ×0.7 |
| 81〜100 | ×0.5 |

### 2-3. 計略（軍事・対外）

| 項目 | 内容 |
|------|------|
| 目的 | 特定のターゲット（武将・拠点）に対し工作を行い、自勢力に有利な状況を作る |
| 成功率の積み上げ | ゲージを貯めて「成功率」を向上させる（%表示） |
| 実行判定 | 方針期間終了時に、最終的な成功率に基づいて実行成否が決まる |
| 使用可能な手段 | 敵情視察、内通者への接触、補給路の妨害、放火、流言の流布 |

#### 直列フェーズ制（計略の具体化）

計略は「外側から徐々に標的を追い詰める」体験を重視し、以下の**直列3段階フェーズ**を順に突破する仕組みとする。

1. **【外縁探査】（がいえんたんさ）**: 外側の情報収集・噂の流布。
2. **【潜行手引】（せんこうてびき）**: 協力者の確保・内部へのルート確立。
3. **【本懐工作】（ほんかいこうさく）**: 本人交渉・現場仕込み。**ここでのみ実行可能。**

#### ターゲットと手法の分類

| カテゴリ | 手法（Method） | 内容 |
|----------|----------------|------|
| **対・武将** | `引き抜き`, `内応`, `離間` | 寝返り、合戦時の裏切り、不和の醸成 |
| **対・拠点** | `流言`, `放火`, `補給路妨害` | 治安・民忠低下、防御力低下、回復抑制 |

> [!NOTE]
> **外交システムとの分離**: `婚姻`, `同盟` 等の政治交渉は、本「計略」方針ではなく、将来実装の「外交システム」で扱う。

#### 成功率（進捗）と難易度

| 属性 | 説明 |
|------|------|
| 成功率 | 第3段階で積み上げた進捗。100%を目指すが難易度補正がかかる |
| 難易度係数 | ターゲットの属性（忠誠、**防諜ステータス**）により 0.1 〜 1.0 で変動 |
| 絶対不可能 | 忠誠100の武将など。いくら進捗を上げても成功率は極めて低い（5%以下） |

#### 手段ゲージ上昇率と計略進捗の関係
計略は直列3段階フェーズという構造的難易度を持つため、**進捗度による上昇率の低下（逓減）は適用しない（常に1.0倍）。**

#### 防諜（戦略防御）
敵の計略から自国を守る「守りの工作」。
- **ターゲット**: 自勢力の拠点、または支配地域。
- **プロセス**: 通常の計略と同様、3フェーズ（外縁探査→潜行手引→本懐工作）を辿る。
- **効果**: 段階を完了するごとに、その地域の**敵計略の進行効率を抑制（デバフ）**する効果が常時発動する。
    - **第1段階完了**: 敵の進捗効率を **-30%** 抑制
    - **第2段階完了**: 敵の進捗効率を **-40%** 抑制
    - **第3段階完了**: 敵の進捗効率を **-50%** 抑制
- **維持管理**: 防諜方針が解除されると、ゲージはターン経過とともに自然減衰する。

| 項目 | 値 |
|------|----|
| 初期計略成果 | 0（固定） |
| 初期手段ゲージ | 0 |
| 最低目標（計略成果） | 20 |
| 挑戦目標（計略成果） | 40 |
| 卓越目標（計略成果） | 60 |


---

## 3. 方針の生成ロジック

### 3-1. 生成タイミング

- **大評定時**（24ターン周期：ターン1, 25, 49, ...）
- **中評定時**（8ターン周期：ターン1, 9, 17, ...）
- 方針の切り替えは大評定、中評定でのノルマ更新、小評定での4ターン単位ノルマという階層構造をとる。

### 3-2. 方針の選択ロジック

```typescript
function generateNewPolicy(player: PlayerState): PolicyState {
    // 方針の選択（重み付きランダム）
    const weights = getPolicyWeights(player)
    const selectedType = weightedRandom(weights)
    
    // 方針の初期値と目標値を設定
    const config = POLICY_CONFIG[selectedType]
    const initialProgress = config.initialProgress
    const initialGauge = config.initialGauge ?? 0
    const initialMeritGauge = config.initialMeritGauge ?? 0
    const targetProgress = config.baseTargetProgress
    const challengeProgress = targetProgress + config.challengeBonus
    const excellentProgress = targetProgress + config.excellentBonus
    
    return {
        type: selectedType,
        issuedTurn: player.week,
        dueTurn: nextEvaluationTurn(player.week),
        progress: initialProgress,
        budget: config.initialBudget,
        gauge: initialGauge,
        meritGauge: initialMeritGauge,
        targetProgress,
        challengeProgress,
        excellentProgress,
        status: 'active',
    }
}
```

### 3-3. 方針の重み付け

```typescript
function getPolicyWeights(player: PlayerState): Record<PolicyType, number> {
    // 基本重み（均等）
    const baseWeights: Record<PolicyType, number> = {
        '治安回復': 40,
        '軍備増強': 35,
        '計略': 25,
    }
    
    // 役職による調整
    if (player.rank === '徒士') {
        // 徒士は治安回復が多め、計略は少なめ
        baseWeights['治安回復'] += 10
        baseWeights['計略'] -= 10
    } else if (player.rank === '馬上衆') {
        // 馬上衆は均等
    } else if (player.rank === '小頭') {
        // 小頭は計略が増える
        baseWeights['計略'] += 10
        baseWeights['治安回復'] -= 5
        baseWeights['軍備増強'] -= 5
    }
    
    // 連続防止：前回と同じ方針は重みを下げる
    // （実装時に前回方針を保持する必要あり）
    
    return baseWeights
}
```

### 3-4. 連続防止ルール

- 同じ方針が3回連続で出ないようにする
- 2回連続の場合、3回目は他の方針から選択

```typescript
function preventConsecutive(
    selectedType: PolicyType,
    history: PolicyType[]
): PolicyType {
    // 直近2回が同じ方針の場合、別の方針を選択
    if (history.length >= 2 &&
        history[0] === selectedType &&
        history[1] === selectedType) {
        const others = POLICY_TYPES.filter(t => t !== selectedType)
        return others[Math.floor(Math.random() * others.length)]
    }
    return selectedType
}
```

---

## 4. 方針の状態遷移

```
[なし] → [active] → [succeeded] or [failed]
            ↓
         評定時に評価
            ↓
       次の方針を生成
```

### 4-1. 状態の定義

| 状態 | 意味 |
|------|------|
| active | 進行中（プレイヤーが行動可能） |
| succeeded | 最低目標を達成して終了 |
| failed | 最低目標未達で終了 |

### 4-2. 状態遷移の条件

```typescript
function evaluatePolicy(policy: PolicyState): EvaluationGrade {
    // 1. 進捗による基礎評価
    let grade = 'failed'
    if (policy.progress >= policy.excellentProgress) grade = 'excellent'
    else if (policy.progress >= policy.challengeProgress) grade = 'good'
    else if (policy.progress >= policy.targetProgress) grade = 'normal'

    // 2. ROIによる調整
    // ROI = (最終進捗 - 初期進捗) / (消費予算)
    const roi = calculateROI(policy)
    if (roi > ROI_EXCELLENT_THRESHOLD) {
        // 高ROIなら評価を1ランク上げる可能性がある（またはボーナス功績）
    }

    return grade
}
```

---

## 5. データ構造

### 5-1. PolicyState（方針の状態）

```typescript
export interface PolicyState {
    type: PolicyType              // 方針の種類
    plotTarget?: string           // 計略のターゲット名（例：武将A、犬山城）
    plotMethod?: string           // 計略の具体的手法（例：流言、放火）
    plotCategory?: 'person' | 'base' // 計略のカテゴリ
    plotPhase: 1 | 2 | 3          // 現在のフェーズ
    issuedTurn: number            // 発行ターン
    dueTurn: number               // 期限ターン（評定ターン）
    progress: number              // 現在の進捗（治安度など、0〜100）
    budget: number                // 方針予算（公費。手段実行で消費）
    gauge: number                 // 手段ゲージ（0〜100、100で進捗+1）
    meritGauge: number            // 方針ゲージ（手柄の目安。進捗効率には影響しない）
    targetProgress: number        // 最低目標
    challengeProgress: number     // 挑戦目標
    excellentProgress: number     // 卓越目標
    status: 'active' | 'succeeded' | 'failed'
}
```

### 5-2. POLICY_CONFIG（方針の設定定数）

```typescript
export const POLICY_CONFIG: Record<PolicyType, {
    name: string
    description: string
    actions: ActionType[]
    initialProgress: number
    initialGauge?: number
    initialMeritGauge?: number
    baseTargetProgress: number
    challengeBonus: number
    excellentBonus: number
    initialBudget: number
    gaugeMultiplierTable?: { maxProgress: number; multiplier: number }[]
}> = {
    '治安回復': {
        name: '治安回復',
        description: '領内の治安を回復し、百姓が安心して暮らせるようにする',
        actions: ['巡察', '情報収集', '盗賊討伐'],
        initialProgress: 20,
        initialGauge: 0,
        baseTargetProgress: 60,
        challengeBonus: 20,
        excellentBonus: 35,
        initialBudget: 5.0,     // 方針予算：5貫支給
        // ゲージ上昇率の倍率テーブル（治安度に応じて変化）
        gaugeMultiplierTable: [
            { maxProgress: 20, multiplier: 2.0 },   // 治安度0〜20: ×2.0
            { maxProgress: 40, multiplier: 1.5 },   // 治安度21〜40: ×1.5
            { maxProgress: 60, multiplier: 1.0 },   // 治安度41〜60: ×1.0
            { maxProgress: 80, multiplier: 0.7 },   // 治安度61〜80: ×0.7
            { maxProgress: 100, multiplier: 0.5 },  // 治安度81〜100: ×0.5
        ],
    },
    '軍備増強': {
        name: '軍備増強',
        description: '戦に備えて軍備を整える',
        actions: ['訓練', '装備整備', '演習', '城壁改修'],
        initialProgress: 40,
        initialGauge: 0,
        baseTargetProgress: 60,
        challengeBonus: 20,
        excellentBonus: 35,
        initialBudget: 8.0,     // 方針予算：8貫支給（資材費等で高め）
        gaugeMultiplierTable: [
            { maxProgress: 30, multiplier: 1.4 },
            { maxProgress: 60, multiplier: 1.0 },
            { maxProgress: 80, multiplier: 0.7 },
            { maxProgress: 100, multiplier: 0.5 },
        ],
    },
    '計略': {
        name: '計略',
        description: '敵対勢力や拠点、武将に対し工作を行い、有利な状況を作り出す',
        actions: ['敵情視察', '内通者への接触', '補給路の妨害', '放火', '流言の流布'],
        initialProgress: 0,
        initialGauge: 0,
        baseTargetProgress: 50,      // 成功率50%を最低目標とする
        challengeBonus: 20,
        excellentBonus: 35,
        initialBudget: 10.0,    // 方針予算：10貫支給（工作費等で高め）
        gaugeMultiplierTable: [
            { maxProgress: 10, multiplier: 1.5 },   // 序盤: ×1.5
            { maxProgress: 30, multiplier: 1.0 },   // 中盤: ×1.0
            { maxProgress: 60, multiplier: 0.7 },   // 後半: ×0.7
            { maxProgress: 100, multiplier: 0.5 },  // 終盤: ×0.5
        ],
    },
}
```

---

## 6. gameStore.ts への追加

### 6-1. 状態の追加

```typescript
interface GameState {
    // 既存の状態...
    
    // v0.17追加
    currentPolicy: PolicyState | null
    policyHistory: PolicyType[]  // 直近の方針履歴（連続防止用）
}
```

### 6-2. アクションの追加

```typescript
// 新しい方針を生成
generateNewPolicy: () => void

// 手段ゲージを加算（100で進捗+1）
addGauge: (baseAmount: number) => void

// 方針ゲージ（手柄の目安）を加算
addMeritGauge: (amount: number) => void

// 方針を評価（評定時に呼び出し）
evaluateCurrentPolicy: () => 'excellent' | 'good' | 'normal' | 'failed' | null

### 6-3. 実装例

```typescript
generateNewPolicy: () => {
    const { player, policyHistory } = get()
    if (!player) return
    
    // 重み付きランダムで方針を選択
    const weights = getPolicyWeights(player)
    let selectedType = weightedRandom(weights)
    
    // 連続防止
    selectedType = preventConsecutive(selectedType, policyHistory)
    
    // 方針の設定を取得
    const config = POLICY_CONFIG[selectedType]
    
    const newPolicy: PolicyState = {
        type: selectedType,
        issuedTurn: player.week,
        dueTurn: nextEvaluationTurn(player.week),
        progress: config.initialProgress,
        budget: config.initialBudget,
        gauge: config.initialGauge ?? 0,
        meritGauge: config.initialMeritGauge ?? 0,
        targetProgress: config.baseTargetProgress,
        challengeProgress: config.baseTargetProgress + config.challengeBonus,
        excellentProgress: config.baseTargetProgress + config.excellentBonus,
        status: 'active',
    }
    
    // 履歴を更新（最大2件保持）
    const newHistory = [selectedType, ...policyHistory].slice(0, 2)
    
    set({
        currentPolicy: newPolicy,
        policyHistory: newHistory,
    })
},

// 手段ゲージを加算し、100を超えたら進捗（治安度など）を+1
addGauge: (baseAmount: number) => {
    set((state) => {
        if (!state.currentPolicy) return state
        if (state.currentPolicy.status !== 'active') return state
        
        const policy = state.currentPolicy
        const config = POLICY_CONFIG[policy.type]
        
        // 現在の進捗に応じたゲージ倍率を取得
        const multiplier = getGaugeMultiplier(policy.progress, config.gaugeMultiplierTable)
        const actualAmount = Math.floor(baseAmount * multiplier)
        
        let newGauge = policy.gauge + actualAmount
        let newProgress = policy.progress
        
        // ゲージが100以上になったら進捗+1、ゲージをリセット
        while (newGauge >= 100 && newProgress < 100) {
            newGauge -= 100
            newProgress += 1
        }
        
        // 進捗は0〜100の範囲に収める
        newProgress = Math.min(100, Math.max(0, newProgress))
        newGauge = Math.min(99, Math.max(0, newGauge))
        
        return {
            currentPolicy: {
                ...policy,
                progress: newProgress,
                gauge: newGauge,
            },
        }
    })
},

// 方針ゲージ（手柄の目安）を加算（進捗効率には影響しない）
addMeritGauge: (amount: number) => {
    set((state) => {
        if (!state.currentPolicy) return state
        if (state.currentPolicy.status !== 'active') return state

        const policy = state.currentPolicy
        const nextMeritGauge = Math.min(100, Math.max(0, policy.meritGauge + amount))

        return {
            currentPolicy: {
                ...policy,
                meritGauge: nextMeritGauge,
            },
        }
    })
},

// ゲージ倍率を取得するヘルパー関数
function getGaugeMultiplier(
    progress: number,
    table: { maxProgress: number; multiplier: number }[] | undefined
): number {
    if (!table) return 1.0
    for (const entry of table) {
        if (progress <= entry.maxProgress) {
            return entry.multiplier
        }
    }
    return 1.0
}

evaluateCurrentPolicy: () => {
    const { currentPolicy } = get()
    if (!currentPolicy || currentPolicy.status !== 'active') return null
    
    let result: 'excellent' | 'good' | 'normal' | 'failed'
    let newStatus: 'succeeded' | 'failed'
    
    if (currentPolicy.progress >= currentPolicy.excellentProgress) {
        result = 'excellent'
        newStatus = 'succeeded'
    } else if (currentPolicy.progress >= currentPolicy.challengeProgress) {
        result = 'good'
        newStatus = 'succeeded'
    } else if (currentPolicy.progress >= currentPolicy.targetProgress) {
        result = 'normal'
        newStatus = 'succeeded'
    } else {
        result = 'failed'
        newStatus = 'failed'
    }
    
    set((state) => ({
        currentPolicy: state.currentPolicy ? {
            ...state.currentPolicy,
            status: newStatus,
        } : null,
    }))
    
    return result
},
```

---

## 7. 役職による見え方の違い

### 7-1. 小頭/徒士/馬上衆
- **小評定**（現場レベル）の命令のみ見える
- 「予算はB貫だ。最低限でもゲージ+Q以上は達成せよ。成果を出すほど評価する」
- 進捗ゲージは見えるが、目標数値は「?」表示。**予算の範囲内でアプローチを選択し、成果を最大化させて評価を高める権限**を持つ。

### 7-2. 中評定（足軽大将/組頭）
- **中評定**（月次レベル）の命令と配分予算が見える。
- 「【武将A】の【引き抜き】を月末までに成功率50%以上まで高めよ。予算B貫を配分する」
- 進捗ゲージ、目標数値、配分予算の残量を把握可能。自らも小評定の下知を出し、配下の成果を管理する。

### 7-3. 実装

```typescript
function getVisiblePolicyInfo(policy: PolicyState, rank: Rank): VisiblePolicyInfo {
    if (rank === '足軽大将' || rank === '組頭') {
        // 中評定担当は全情報が見える
        return {
            type: policy.type,
            progress: policy.progress,
            targetProgress: policy.targetProgress,
            challengeProgress: policy.challengeProgress,
            excellentProgress: policy.excellentProgress,
            showTargetNumbers: true,
            budgetVisible: true,
        }
    } else {
        // 馬上衆/徒士（小評定受領者）は目標数値は見えないが、自分の委託予算は見え、アプローチ選定が可能
        return {
            type: policy.type,
            progress: policy.progress,
            targetProgress: null,
            challengeProgress: null,
            excellentProgress: null,
            showTargetNumbers: false,
            budgetVisible: true, // 自分の持ち分が見える
        }
    }
}
```

---

## 8. 初期化とセーブ/ロード

### 8-1. ゲーム開始時

```typescript
initializeGame: (name, potential) => {
    // 既存の初期化処理...
    
    // v0.17追加：初期方針を生成
    const initialPolicy = generateInitialPolicy(player)
    
    set({
        player,
        rival,
        currentPolicy: initialPolicy,
        policyHistory: [initialPolicy.type],
        // ...
    })
}
```

### 8-2. セーブデータ

```typescript
saveGame: () => {
    const state = get()
    const saveData = {
        // 既存...
        currentPolicy: state.currentPolicy,
        policyHistory: state.policyHistory,
        // ...
    }
    // ...
}

loadGame: () => {
    // ...
    set({
        // 既存...
        currentPolicy: saveData.currentPolicy ?? null,
        policyHistory: saveData.policyHistory ?? [],
        // ...
    })
}
```

---

## 9. テスト観点

### 9-1. 方針生成

- [ ] 評定時に新しい方針が生成されるか
- [ ] 3種類の方針がランダムに選ばれるか
- [ ] 同じ方針が3回連続で出ないか
- [ ] 役職による重み付けが機能しているか

### 9-2. 進捗更新

- [ ] 手段の実行で進捗が増加するか
- [ ] 進捗が0〜100の範囲に収まるか
- [ ] 進捗が正しく保存/復元されるか

### 9-3. 評価

- [ ] 評定時に正しく評価されるか
- [ ] 卓越/優秀/平凡/未達の判定が正しいか
- [ ] 評価結果に応じた報酬が付与されるか

### 9-4. 表示

- [ ] 役職による見え方の違いが正しいか
- [ ] 進捗ゲージが正しく表示されるか
- [ ] 目標数値の表示/非表示が正しいか
